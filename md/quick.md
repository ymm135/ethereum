- # 知识速览  

## 以太坊

### 以太币和其他代币的区别  
**发行方式**：以太币是以太坊平台上的原生加密货币，由矿工通过挖矿获得。而其他代币通常是由发行人创建并发行的。  

**用途**：以太币可以用于支付以太坊网络中的交易费用，以及作为一种价值储存和交换的资产。其他代币可能具有不同的用途，例如代表`特定资产`或`服务的价值`。  

**原生支持**：以太币是以太坊平台的本地加密货币，因此在以太坊上很容易处理和交易。其他代币可能需要特定的钱包或交易所才能处理和交易。  

**发行数量**：以太币的总供应量是有限的，目前约为`1.15`亿枚，而其他代币的供应量可以是无限的。  

**价值波动**：以太币的价格波动相对较大，因为它是一种主要加密货币之一。其他代币的价值波动可能相对较小，因为它们通常没有像以太币这样的广泛应用。  

综上所述，以太币是以太坊平台上的原生加密货币，而其他代币是基于以太坊平台上的智能合约创建的代币。它们在发行方式、用途、原生支持、发行数量和价值波动等方面存在一些不同。  

### 交易平台  

以太币（ETH）是一种流行的`加密货币`，可以在许多不同的交易平台上进行交易。以下是一些常见的以太币交易平台：

- Coinbase Pro：这是一个受欢迎的加密货币交易平台，支持多种加密货币交易，包括以太币。
- `Binance`：这是一个全球最大的加密货币交易平台之一，也支持以太币交易。
- Kraken：这是一个受欢迎的加密货币交易平台，也支持以太币交易。
- Bitfinex：这是一个加密货币交易平台，支持以太币交易以及其他许多加密货币。
- Huobi：这是一个位于新加坡的加密货币交易平台，也支持以太币交易。
- Gemini：这是一个受欢迎的加密货币交易平台，由Cameron和Tyler Winklevoss创立，也支持以太币交易。

这些仅仅是一些常见的以太币交易平台，当然还有其他的交易平台也支持以太币的交易。但是，交易平台之间存在差异，包括手续费、用户体验、支持的货币和交易量等。因此，建议您在选择交易平台时，仔细研究并选择最适合您的平台。  

### BNB兑换以太币的比率是如何确定的？

BNB兑换以太币的比率是由`市场供求`关系决定的，通常可以在各大加密货币交易所上查看。因为BNB和以太币都是加密货币，在交易所上，它们可以通过交易对进行兑换，交易对通常是指BNB/ETH。

在一个典型的交易所上，买方和卖方会通过`交易`来达成`价格协商`。如果有更多的买家想购买BNB，但卖家数量不够，则`BNB`价格会上涨。反之，如果卖家数量较多，则价格可能下跌。这种供求关系会在市场上导致价格波动，从而决定BNB和以太币的兑换比率。

此外，交易所还可能对交易进行各种手续费，例如交易费用和提款费用，这些费用也会影响兑换比率。因此，在选择交易所进行BNB和以太币之间的兑换时，交易费用也是需要考虑的因素之一。

总的来说，BNB和以太币之间的兑换比率是由市场供求关系以及交易所的交易费用等因素决定的。  

### DeFi 币 是什么?
DeFi币是指与去中心化金融（DeFi）相关的`加密货币`。DeFi币的出现是因为随着去中心化金融的快速发展，越来越多的项目开始在区块链上构建新的金融应用和服务，这些应用和服务通常使用代币来实现价值传输和交换。

DeFi币通常是在去中心化交易所（DEX）上交易的，这些交易所不像中心化交易所（CEX）那样需要中心化的中介机构来处理交易。由于去中心化交易所具有高度的安全性、透明性和无需信任的特性，因此在过去几年中逐渐成为DeFi币交易的主要场所。

DeFi币的功能和用途各不相同，其中一些代币是用于支付交易费用或参与治理决策的，而其他代币则可以作为流动性提供者或借贷者的抵押品。许多DeFi币还支持利息收益、交易挖矿和代币奖励等机制，这些机制可以吸引用户参与项目和交易。

一些常见的DeFi币包括以太坊上的UNI、AAVE、COMP等代币，以及基于波卡（Polkadot）和索尔（Solana）等其他区块链上的代币。总的来说，DeFi币是一种与去中心化金融相关的数字资产，代表着这个新兴领域的创新和发展。

### uniswap v2是什么？
Uniswap V2是Uniswap协议的第二个版本，是基于以太坊网络的`去中心化交易协议`。它是Uniswap V1的升级版，于2020年5月上线，引入了一些新的特性和功能，旨在提高交易体验和流动性。

Uniswap V2最显著的特点是引入了流动性提供者费用升级机制，让流动性提供者获得更高的收益。在Uniswap V2中，交易对的每个资产都有一个单独的费用率，这意味着流动性提供者可以获得每个资产的收益。此外，Uniswap V2还支持限价单和闪电贷等新的功能，用户可以使用限价单指定交易价格，或使用闪电贷在无需资金占用的情况下进行交易。

Uniswap V2的交易过程与Uniswap V1相似，用户可以直接在协议中交易代币，无需交易对的配对和订单簿。此外，Uniswap V2还提供了一些定价模型，使交易更加高效和准确。

总的来说，Uniswap V2是一个更加高级和功能丰富的去中心化交易协议，可以更好地满足用户和流动性提供者的需求，并在DeFi生态系统中发挥着越来越重要的作用。


### uniswap协议是智能合约吗？
是的，Uniswap协议是一个基于以太坊智能合约的去中心化交易协议。它使用智能合约来管理资金池和交易机制，并通过以太坊网络实现资产交换。在Uniswap中，`智能合约充当着交易对的中间人`，自动管理流动性和交易流程，使用户能够在无需信任第三方的情况下进行代币交易。  

Uniswap协议的智能合约代码是开源的，任何人都可以查看和审查代码。此外，Uniswap协议的智能合约是无需许可的，任何人都可以在以太坊网络上部署和使用该协议。  

智能合约是区块链技术的重要组成部分，可以使协议和应用程序在不需要中心化实体的情况下运行。在DeFi领域，智能合约可以实现多种金融协议和应用程序，如去中心化交易、闪电贷款、稳定币和流动性挖掘等。  

### eth 跟 weth 如何互相转化?

ETH（以太币）和WETH（Wrapped ETH）之间可以通过智能合约进行互相转换。WETH是一种ERC-20代币，其价值与ETH相同，但可以在以太坊网络中进行更方便的交易和使用。以下是ETH和WETH之间互相转换的一些常见方法：

通过交易所进行转换：用户可以在支持ETH和WETH交易对的交易所中，将ETH存入交易所账户，并交易为WETH。同样，用户也可以在交易所中将WETH兑换为ETH。

使用DApp进行转换：许多去中心化应用程序（DApp）支持ETH和WETH之间的兑换。例如，在Uniswap和Kyber Network等DApp中，用户可以直接交换ETH和WETH。

通过智能合约进行转换：用户也可以使用智能合约直接将ETH和WETH之间进行转换。例如，在0x Protocol的WETH合约中，用户可以使用"deposit"函数将ETH转换为WETH，或使用"withdraw"函数将WETH转换为ETH。在进行转换时，用户需要授权智能合约访问自己的资金。

无论采用何种方法，ETH和WETH之间的转换都是基于智能合约进行的，旨在方便以太坊网络中的资产交换和使用。

### uniswap的原理介绍  

https://github.com/ymm135/dapp-learning/tree/master/basic/13-decentralized-exchange/uniswap-v1-like

### uniswap v2套利机制
Uniswap V2的套利机制与Uniswap V1类似，但是在一些方面有所不同。

Uniswap V2使用的是同比例恒定乘积模型（Constant Product Market Maker Model），即交易对中两种代币的数量的乘积是一个常数，而不是V1的常量K值。这意味着在交易对中，当一种代币的价格上涨时，另一种代币的数量会相应下降，以保持乘积不变。这也是导致Uniswap V2中存在套利机会的主要原因之一。

Uniswap V2的套利机会与V1类似，主要包括价格差异和流动性挖矿奖励。价格差异套利是指在不同交易对之间进行买卖以获得利润。例如，在一个交易对中，代币A的价格比另一个交易对中的代币A价格更高，可以在第一个交易对中以代币B购买代币A，然后在第二个交易对中以代币A出售代币B，从中获得利润。

流动性挖矿奖励套利是指通过提供流动性，并获得流动性提供者奖励来获得利润。在Uniswap V2中，提供流动性可以获得交易费和UNI代币的奖励。因此，套利者可以利用这一机会，在交易所获得更高的回报率。

需要注意的是，Uniswap V2中的套利机会存在一定的风险，例如交易成本、流动性不足、资产安全等。因此，进行套利操作需要谨慎考虑和操作。

### uniswap中的滑点是什么意思？

在Uniswap中，滑点（Slippage）是指在进行交易时，实际成交价格和预期价格之间的差异。这个差异主要是由于交易发生时，交易对中代币的价格和数量都会发生变化，从而导致交易价格的波动。

Uniswap的交易对是基于同比例恒定乘积模型（Constant Product Market Maker Model）的，这意味着交易对中代币的数量的乘积是一个固定的值。当买入或卖出某种代币时，该代币的价格会发生变化，因为与之成对的代币数量也会随之变化。因此，在进行交易时，需要设置一个滑点来允许价格波动。滑点越高，交易成交的可能性越大，但是成交价格可能会偏离预期价格；滑点越低，成交价格会更接近预期价格，但是交易成交的可能性会降低。

当一个用户在Uniswap中进行交易时，系统会根据当前的汇率自动计算需要支付的代币数量。比如，如果一个用户想要以1个以太币购买100个DAI，那么Uniswap会根据当前汇率计算出需要支付的代币数量。假设当前汇率是1 ETH = 100 DAI，那么用户需要支付1个ETH才能获得100个DAI。

然而，由于Uniswap的交易所使用的同比例恒定乘积模型，交易所使用的代币数量会影响价格。这意味着，当一个用户试图购买大量的某种代币时，他们需要支付更多的代币才能获得相同数量的另一种代币。这种情况可能导致实际成交价格偏离预期成交价格，这就是滑点。

例如，假设当前汇率是1 ETH = 100 DAI，并且当前市场上的流动性非常低，那么一个用户想要以1 ETH购买100 DAI可能需要支付更多的ETH。这是因为在这种情况下，购买100 DAI所需的ETH数量已经超出了市场上可以提供的ETH数量，从而导致实际成交价格偏高。

为了减少滑点带来的影响，Uniswap提供了一个滑点限制功能。滑点限制是指用户愿意接受的最大滑点大小，如果滑点超过了这个限制，交易将会被取消。通常，滑点限制的大小应该根据市场情况和用户的风险承受能力来确定。如果用户设置了一个很低的滑点限制，那么交易可能会被取消，因为实际成交价格偏离预期成交价格的可能性非常高。反之，如果用户设置了一个较高的滑点限制，那么交易成功的可能性会更高，但是他们可能会支付更多的代币才能获得相同数量的另一种代币。

--- 
具体的示例:  

假设当前市场上的ETH/DAI交易对的流动性比较低，目前的价格是1 ETH = 1000 DAI。假设一个用户想要以1 ETH的价格购买100 DAI的代币，那么根据当前的汇率，这个用户应该能够购买100 DAI的代币。

但是，由于当前流动性比较低，假设此时这个用户提交了一个市价订单，想要以市场上最优的价格购买100 DAI的代币。然而，由于流动性不足，交易所只能提供1 ETH换取80 DAI，这就意味着这个用户的订单只能以这个价格成交。

在这个例子中，滑点将是20%。因为该用户想要购买100 DAI，但由于缺乏流动性，最终只能购买到80 DAI，因此实际成交价格偏离了预期成交价格。因此，滑点就是(100 - 80)/100 = 0.2，也就是20%。

如果该用户设置了一个10%的滑点限制，那么当滑点超过这个限制时，交易将会被取消。在这种情况下，由于滑点达到了20%，交易将会被取消，因为实际成交价格已经超过了用户设置的滑点限制。


### uniswap 的流动性是什么意思？
在 Uniswap 中，流动性是指某个交易对（例如 ETH/DAI）中可供交易的一方提供的资金数量。这些资金可以用来购买或出售另一种代币。当一个用户想要进行交易时，他可以从流动性池中获取资金，以便购买或出售另一种代币。

流动性池由 Uniswap 用户提供，他们将一定数量的两种代币存入池中，以便交换。例如，一个用户可以将 1 ETH 和 1000 DAI 存入 ETH/DAI 流动性池中。当其他用户想要进行 ETH/DAI 交易时，他们可以从该池中获取资金。在交易结束时，流动性提供者可以从该池中提取他们贡献的资金，以及一定比例的交易费。

Uniswap 的流动性池是基于自动化做市商（AMM）的设计，其工作方式不同于传统的中心化交易所。因此，用户在 Uniswap 上交易时，他们交易的是`流动性`池中的资金，而不是`交易对手方`的资金。这也使得 Uniswap 的交易流程更加简单和透明。

### uniswap的无常损失？

Uniswap 中的“无常损失”是指提供流动性的用户在交易对池中持有两种代币时，由于价格波动导致代币比例发生变化，从而造成其投入的价值发生缩水的损失。这种损失是在用户提供流动性时，即存入两种代币到交易对池中时就会产生的。

这种损失的发生原因在于，Uniswap 采用的是自动化做市商（AMM）的设计，这意味着流动性提供者的资金会自动用于交易，以确保在池中的两种代币之间始终保持相对均衡的比例。当某种代币价格发生剧烈波动时，偏离原有的比例，这就会导致一个代币的价值相对另一个代币发生变化，从而导致流动性提供者的资金价值发生损失。

例如，如果用户提供 ETH/DAI 交易对的流动性，其中 ETH 的价值为 10,000 美元，DAI 的价值为 5,000 美元。如果 ETH 的价格突然上涨，使得 ETH 在交易对中的价值占比增加到 80%，而 DAI 的占比降至 20%，那么这位流动性提供者就会发生无常损失，因为他们此时持有的 ETH 相对于 DAI 的价值增加，但实际上无法将这些 ETH 直接出售以获得更多的 DAI。因此，他们的总资产价值可能会下降。

尽管无常损失是 Uniswap 的一个缺点，但是它的去中心化和无需许可的交易特性，以及流动性提供者可获得的一定比例的交易费，使得它仍然成为加密货币交易中非常流行的一种方式。


### 无偿损失计算?  

Uniswap的矿池价值比例都为`50/50`。假设你在UniSwap上代币A/B矿池中按照1A = 50B的价格存入了10个A和500个B。而这个池中一共有100个A和5000个B，你的份额占10%。  

| 代币 | 数量 | 价格  | 价值  |
| --- | ---- | ----- | ---- |
| A   | 100  |  50   | 5000 | 
| B   | 5000 | 1    | 50000 | 


由AMA的固定乘积公式可知，`K=100*5000=500,000`

当市场价格波动至`1A=100B`，而此时Uniswap中的A/B流动性池价格还是`1A = 50B`。这时`套利者`就会进入，在流动性池中用`B换取A`，再在其它中心化交易所卖出。这样就会造成A数量下降，B数量升高，从而重新达到一个平衡，使价格稳定在`1A=100B`。

而AMA的固定乘积公式中，K为定值，保持不变。假设在稳定后池总A总数数量变成X，B的数量变成Y，那么：

`X*Y=K=500,000`

100X=Y

解出X,Y，得到：
| 代币 | 数量 | 价格  | 价值  |
| --- | ---- | ----- | ---- |
| A   | 70.71  |  100   | 7071 | 
| B   | 7071.0 | 1    | 7071 | 

价格波动后，由于你的份额占据池中的10%，你的持有代币价值为7.071A+707.1B=14.14A

而假设如果你没有进行流动性提供，持有的A和B都在个人钱包里放着，那么你现在还是拥有`10A+500B=15A`

你的无常损失为：

15A-14.14A=0.86A

因此，可以发现，因为你提供了流动性，代币对价格波动后，你的资产价值反而缩水了。当然了，因为的流动性中做市商可以收取手续费，手续费是否能跑赢无常损失就是一个未知数了。  

### 如何获取池子的数据？

要获取 Uniswap 中交易对池的数据，可以通过以下两种方式：

Uniswap 官方接口：Uniswap 提供了一些公共 API，可以用来获取交易对池的数据。通过这些 API，你可以获取当前交易对池中两种代币的储备量、价格、交易量等信息。具体的接口文档可以在 Uniswap 的官方网站上查看。

第三方数据服务提供商：除了使用 Uniswap 官方接口，还可以通过一些第三方数据服务提供商来获取 Uniswap 交易对池的数据。这些服务商通常会提供更全面的数据，例如历史价格、交易量、成交量、交易对池的总价值等，以帮助用户更好地了解市场和交易情况。一些常见的数据服务提供商包括 Dune Analytics、CoinGecko 和 CoinMarketCap 等。

无论使用哪种方式获取 Uniswap 的交易对池数据，都需要注意数据的实时性和准确性，以避免产生误差。

以下是一个 Uniswap 中 ETH-USDC `交易对池`的数据示例：

ETH 储备量：5,000 ETH  
USDC 储备量：10,000 USDC  
ETH 价格：2,000 USDC/ETH  
USDC 价格：0.0005 ETH/USDC  
24 小时交易量：1,000 ETH  
24 小时手续费收入：10 ETH  

这个示例中，ETH 的储备量为 5,000 个，USDC 的储备量为 10,000 美元。因为 ETH-USDC 是一个交易对，所以我们可以根据池中的`储备量`和`价格`计算出 ETH 和 USDC 的交易比率，即 ETH/USDC 的价格是 2,000/1 = 2,000 USDC/ETH，而 USDC/ETH 的价格是 1/2,000 = 0.0005 ETH/USDC。

在这个示例中，24 小时交易量为 1,000 个 ETH，这意味着有 1,000 个 ETH 从这个交易对池中买入或卖出。同时，这个交易对池还收取了 10 个 ETH 的手续费。

这些数据可以用来分析市场的`趋势`和`交易`活动，也可以用来计算交易的`成本`和`收益`。但需要注意的是，这些数据可能会随着时间的推移而变化，因此在进行分析和决策时需要注意数据的实时性和准确性。

以下是 Uniswap 中 ETH-USDC 交易对池的实际 JSON 数据示例：
```json
{
  "data": {
    "token0": {
      "id": "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",
      "symbol": "ETH",
      "name": "Ethereum"
    },
    "token1": {
      "id": "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
      "symbol": "USDC",
      "name": "USD Coin"
    },
    "reserve0": "4998469040622666573834",
    "reserve1": "9929688393766603337864",
    "reserveETH": "16667662.867325139346189203",
    "reserveUSD": "19970438.011518013073021526",
    "totalSupply": "145456.252623798163099743",
    "liquidityProviderCount": 555,
    "volumeUSD": "578429.0264155273494799256417672",
    "feeTier": 500
  }
}
```

这个 JSON 数据提供了 ETH-USDC 交易对池的各种信息，包括了两种代币的 ID、代币符号、代币名称、储备量、总供应量、流动性提供者数量、24 小时交易量、手续费费率等等。

其中，reserve0 表示 ETH 的储备量，单位为 wei；reserve1 表示 USDC 的储备量，单位为 USDC 的最小单位（例如，对于 USDC 来说，最小单位为 1/1e6 的 USDC）；reserveETH 和 reserveUSD 分别表示以 ETH 和 USD 为计价单位的储备量；totalSupply 表示交易对池的总供应量；liquidityProviderCount 表示提供流动性的用户数量；volumeUSD 表示 24 小时的交易量，以 USD 为计价单位；feeTier 表示手续费费率。

这些数据可以通过 Uniswap 的 API 或其他数据源获取，以进行分析、交易和决策。 


### 在一个池子中，如何通过交易对币的数量计算价格呢？
在一个池子中，可以通过交易对币的数量计算价格，具体步骤如下：

1. 确定交易对：在一个池子中，有两种代币，我们可以将它们称作 Token A 和 Token B，其中 Token A 是基础代币，Token B 是交易代币。例如，在 ETH/USDT 池子中，ETH 可以看作是基础代币，USDT 是交易代币。

2. 获取池子中 Token A 和 Token B 的余额：通过查询池子中的合约，可以获得当前池子中 Token A 和 Token B 的余额，分别表示为 A 和 B。

3. 计算池子的`总价值`：池子的总价值等于 A 和 B 的数量之积。即 `A * B = K`，其中 K 表示常量。

4. 确定交易前后的 Token A 和 Token B 的数量：假设一个交易前，池子中的 Token A 和 Token B 的数量分别为 A1 和 B1，交易后的数量分别为 A2 和 B2。在这个交易中，用户希望用 X 个 Token A 换取 Y 个 Token B。

5. 计算交易前后池子常量的变化：交易前后池子常量的变化量等于常量 K 乘以变化前后的自然对数之差。即 ln(A1/B1) - ln(A2/B2) = ln((A1B1)/(A2B2))。

6. 计算交易前后 Token A 和 Token B 的价格：交易前后 Token A 和 Token B 的价格分别等于池子总价值除以对应代币的数量。即交易前 `Token A` 的价格为 `A1/B1`，交易后 `Token A` 的价格为 `A2/B2`；交易前 `Token B` 的价格为 `B1/A1`，交易后 `Token B` 的价格为 `B2/A2`。

计算交易价格和实际成交价格的差值：实际成交价格等于交易前后 Token A 或 Token B 价格的加权平均值。交易价格和实际成交价格之间的差值被称为`滑点`。滑点越大，交易成本越高。  


### uniswap套利原理？
Uniswap是一个去中心化交易平台，其中的交易对价格是由市场供需决定的，并且每个交易对都是一个自己的流动性池。由于Uniswap是基于以太坊智能合约的，因此交易和价格数据都是公开的，并且可以通过智能合约进行访问和查询。

Uniswap套利的基本原理是利用不同交易对之间的价格差异进行交易，从而获得利润。例如，假设有两个交易对A和B，其中A包含ETH和Token1，B包含ETH和Token2。如果Token1和Token2之间存在价格差异，那么就可以通过以下步骤进行套利交易：

1. 用ETH在交易对A中购买Token1；  
2. 将Token1用交易对B中的ETH兑换成Token2；  
3. 将Token2卖回ETH，获得利润。  

通过这个过程，可以利用价格差异在Uniswap上进行套利交易。值得注意的是，由于Uniswap是一个自动化做市商，价格会根据交易对的流动性自动调整，因此套利的机会可能会很短暂，并且有可能被其他交易者利用。

此外，还有一些高级的套利策略，如闪电贷、潜在交易对等，这些策略可以通过多个交易对之间的价格差异来获取更高的利润。不过，这些策略需要更高的技术门槛和更复杂的交易逻辑，不适合普通投资者。  

> 如果发现套利机会，被别人抢先了，那有可能以市场价得到token，再加上手续费，一定是亏钱的。  













